ä»¥ä¸‹æ˜¯ä¸ºä½ é‡èº«è®¾è®¡çš„â€œ**ä¸­çº§å®æˆ˜é˜¶æ®µ GitHub ä»£ç ä»“åº“ç»“æ„å›¾**â€ï¼Œç”¨äºä½¿ç”¨ **Terraform + Vagrant + VMware Workstation Pro / VirtualBox** æ­å»º**å¤šèŠ‚ç‚¹ Kubernetes å­¦ä¹ é›†ç¾¤**ï¼Œå¹¶é€šè¿‡ä¸€å°èŠ‚ç‚¹éƒ¨ç½² NFS Serverï¼Œæ”¯æŒ PVC æŒä¹…åŒ–æŒ‚è½½ã€‚

è¯¥æ–¹æ¡ˆé€‚åˆæ·±å…¥ç†è§£ K8s ç»„ä»¶éƒ¨ç½²ã€å¤šèŠ‚ç‚¹è°ƒåº¦ã€NFS å­˜å‚¨ç»‘å®šç­‰ä¸­å®æˆ˜æŠ€èƒ½ï¼Œæ¶æ„æ¸…æ™°ã€å¯å¤ç”¨æ€§å¼ºã€‚

---

## ğŸ“ GitHub é¡¹ç›®ç»“æ„å›¾ï¼š`k8s-vagrant-terraform-nfs`

```
k8s-vagrant-terraform-nfs/
â”œâ”€â”€ terraform/                              # Terraform ç®¡ç†è™šæ‹Ÿæœºç”Ÿå‘½å‘¨æœŸ
â”‚   â”œâ”€â”€ main.tf                             # ä½¿ç”¨ null_resource æˆ– vagrant-exec åˆ›å»ºè™šæ‹Ÿæœº
â”‚   â”œâ”€â”€ variables.tf                        # è™šæ‹Ÿæœºå‚æ•°é…ç½®ï¼ˆæ•°é‡ã€å†…å­˜ç­‰ï¼‰
â”‚   â”œâ”€â”€ outputs.tf                          # è¾“å‡º SSH ä¿¡æ¯ã€kubeconfig ç­‰
â”‚   â””â”€â”€ provision.sh                        # è™šæ‹Ÿæœºåˆå§‹åŒ–è„šæœ¬å…¥å£ï¼ˆè§¦å‘ kubeadmã€NFS å®‰è£…ï¼‰
â”‚
â”œâ”€â”€ vagrant/                                # Vagrant å¤šèŠ‚ç‚¹è™šæ‹Ÿæœºé…ç½®
â”‚   â”œâ”€â”€ Vagrantfile                         # æ”¯æŒå¤šèŠ‚ç‚¹ï¼ˆå¦‚ 1 Master + 2 Nodeï¼‰
â”‚   â””â”€â”€ scripts/
â”‚       â”œâ”€â”€ install_k8s.sh                  # åœ¨æ¯ä¸ªèŠ‚ç‚¹ä¸Šå®‰è£… Kubernetes ç»„ä»¶
â”‚       â”œâ”€â”€ setup_nfs_server.sh            # å®‰è£…å¹¶é…ç½® NFS æœåŠ¡ï¼ˆåœ¨å…¶ä¸­ä¸€ä¸ªèŠ‚ç‚¹ï¼‰
â”‚       â”œâ”€â”€ init_master.sh                 # Master èŠ‚ç‚¹ kubeadm init + ç½‘ç»œæ’ä»¶
â”‚       â””â”€â”€ join_node.sh                   # Node èŠ‚ç‚¹åŠ å…¥é›†ç¾¤
â”‚
â”œâ”€â”€ manifests/                              # Kubernetes å­˜å‚¨å’Œæµ‹è¯•èµ„æºæ¸…å•
â”‚   â”œâ”€â”€ nfs-pv.yaml                         # ä½¿ç”¨ NFS çš„ PV
â”‚   â”œâ”€â”€ nfs-pvc.yaml                        # PVC ç»‘å®šæµ‹è¯•
â”‚   â””â”€â”€ test-pod.yaml                       # æŒ‚è½½ PVC çš„æµ‹è¯• Pod
â”‚
â”œâ”€â”€ scripts/                                # è¾…åŠ©è„šæœ¬
â”‚   â”œâ”€â”€ apply_all.sh                        # ä¸€é”®éƒ¨ç½²ï¼šTerraform + K8s Init + PV/PVC
â”‚   â””â”€â”€ destroy_all.sh                      # ä¸€é”®é”€æ¯ç¯å¢ƒ
â”‚
â”œâ”€â”€ .gitignore                              # å¿½ç•¥ä¸­é—´æ–‡ä»¶
â”œâ”€â”€ README.md                               # å®‰è£…è¯´æ˜ã€å¹³å°æ”¯æŒã€éƒ¨ç½²æµç¨‹
â””â”€â”€ LICENSE
```

---

## ğŸ§± èŠ‚ç‚¹ç¤ºä¾‹æ¶æ„ï¼ˆé»˜è®¤ï¼‰

* `k8s-master-1`: Kubernetes Control Plane + NFS Server
* `k8s-node-1`, `k8s-node-2`: Worker èŠ‚ç‚¹ï¼ˆé€šè¿‡ kubeadm join åŠ å…¥é›†ç¾¤ï¼‰

> æ‰€æœ‰èŠ‚ç‚¹é€šè¿‡ Vagrant åˆ›å»ºï¼Œå¹¶ç”¨ VirtualBox/VMware Workstation å¯åŠ¨
> æ‰€æœ‰å®‰è£…æ­¥éª¤é€šè¿‡ `provision.sh` å’Œå­è„šæœ¬æ‰§è¡Œï¼ˆè‡ªåŠ¨ sshã€å®‰è£…ä¾èµ–ã€åŠ å…¥é›†ç¾¤ï¼‰

---

## âš™ï¸ æŠ€æœ¯æ ˆç»„ä»¶

| æŠ€æœ¯                                      | ç”¨é€”                            |
| --------------------------------------- | ----------------------------- |
| **Terraform**                           | ç®¡ç†è™šæ‹Ÿæœºç”Ÿå‘½å‘¨æœŸã€è°ƒç”¨ Vagrant          |
| **Vagrant**                             | åˆ›å»ºå¯æ§è™šæ‹Ÿæœºï¼ˆVMware/VirtualBox é©±åŠ¨ï¼‰ |
| **VirtualBox / VMware Workstation Pro** | è™šæ‹ŸåŒ–è¿è¡Œç¯å¢ƒ                       |
| **Kubeadm**                             | å¿«é€Ÿåˆå§‹åŒ–å¤šèŠ‚ç‚¹ Kubernetes é›†ç¾¤        |
| **NFS Server**                          | é…ç½®å…±äº«å­˜å‚¨ï¼Œæ”¯æŒ PVC                 |
| **Shell è„šæœ¬**                            | è‡ªåŠ¨åŒ–å®‰è£… kubeletã€kubeadmã€NFS ç­‰   |

---

## ğŸš€ è¿è¡Œæ­¥éª¤ç®€è¿°

```bash
# 1. åˆå§‹åŒ– Terraform
cd terraform
terraform init
terraform apply

# 2. Terraform è§¦å‘ Vagrant åˆ›å»ºè™šæ‹Ÿæœº & è¿œç¨‹æ‰§è¡Œå®‰è£…è„šæœ¬
# master èŠ‚ç‚¹æ‰§è¡Œ kubeadm init
# node èŠ‚ç‚¹è‡ªåŠ¨ join
# node-1 ä¸Šé…ç½® NFS å…±äº«

# 3. ç™»å½• masterï¼Œéƒ¨ç½² PV/PVC æµ‹è¯•
cd ../manifests
kubectl apply -f nfs-pv.yaml
kubectl apply -f nfs-pvc.yaml
kubectl apply -f test-pod.yaml

# 4. æŸ¥çœ‹æŒ‚è½½æ•ˆæœ
kubectl exec -it test-pod -- sh
df -h
```

---

## âœ… ç‰¹ç‚¹ä¸ä¼˜åŠ¿

| é¡¹ç›®è®¾è®¡        | ä¼˜åŠ¿               |
| ----------- | ---------------- |
| å¤šèŠ‚ç‚¹ç»“æ„       | æ¨¡æ‹Ÿè°ƒåº¦ã€æœåŠ¡éƒ¨ç½²ã€Pod ç½‘ç»œ |
| è‡ªå¸¦ NFS      | å®è·µå…±äº«å­˜å‚¨æŒ‚è½½ PVC     |
| å…¨è„šæœ¬åŒ–éƒ¨ç½²      | é¿å…æ‰‹åŠ¨å®‰è£…ï¼Œæ˜“äºé‡å»º      |
| å¯æ‰©å±•         | ä¿®æ”¹å˜é‡å³å¯å˜æ›´èŠ‚ç‚¹æ•°é‡ã€èµ„æº  |
| æ”¯æŒ Git ç‰ˆæœ¬æ§åˆ¶ | è·¨ç”µè„‘å¤ç°ç¯å¢ƒä¸€è‡´æ€§é«˜      |

---

## ğŸ§© å¯é€‰æ‰©å±•æ–¹å‘

* ä½¿ç”¨ Packer æ„å»ºåŸºç¡€é•œåƒï¼ˆå¸¦ Docker/K8sï¼‰
* æ”¹ç”¨ `remote-exec` å®ç°è¿œç¨‹éƒ¨ç½²æ›´ç»†ç²’åº¦æ§åˆ¶
* åŠ å…¥ Helm / Ingress / Prometheus ç­‰å­¦ä¹ æ¨¡å—
* åŠ å…¥ GitHub Actions éªŒè¯ `kubeadm init` æˆåŠŸå¹¶æµ‹è¯• NFS PVC å¯è¯»å†™

---

å¦‚æœä½ éœ€è¦ï¼š

* âœ… ç”Ÿæˆè¿™å¥—ç›®å½•ç»“æ„ + æ‰€æœ‰æ ¸å¿ƒæ–‡ä»¶
* âœ… å¸®ä½ è¡¥å…¨ `main.tf` / `Vagrantfile` / `provision.sh` å†…å®¹
* âœ… åˆ›å»º GitHub ç¤ºä¾‹ä»“åº“æˆ–æ‰“åŒ…æˆ zip ä¸‹è½½

è¯·å‘Šè¯‰æˆ‘ï¼Œæˆ‘å¯ä»¥ç«‹å³ç”Ÿæˆå¹¶äº¤ä»˜ä½ å¯ä»¥ç›´æ¥ç”¨çš„å·¥ç¨‹æ¨¡æ¿ã€‚æ˜¯å¦ç°åœ¨å¼€å§‹ï¼Ÿä½ æ‰“ç®—ç”¨ **VirtualBox** è¿˜æ˜¯ **VMware Workstation Pro** è¿›è¡Œè™šæ‹Ÿæœºåˆ›å»ºï¼Ÿ
