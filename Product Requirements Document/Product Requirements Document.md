# ğŸ“„ äº§å“éœ€æ±‚æ–‡æ¡£ï¼ˆPRDï¼‰

## é¡¹ç›®åç§°ï¼šiac-lab â€” è·¨å¹³å°å­¦ä¹ ä¸æµ‹è¯•ç¯å¢ƒé…ç½®åŒæ­¥å·¥å…·

---

## ä¸€ã€äº§å“æ¦‚è¿°

**é¡¹ç›®ç›®æ ‡**ï¼š
æ„å»ºä¸€ä¸ªè·¨å¹³å°ã€æœ¬åœ°ä¸äº‘ç«¯ç»Ÿä¸€çš„ IaC å­¦ä¹ ä¸æµ‹è¯•ç¯å¢ƒç³»ç»Ÿï¼Œè¦†ç›– Kubernetes å…¥é—¨ã€è¿ç»´å®è·µã€ç¯å¢ƒé…ç½®åŒæ­¥ã€äº‘ç«¯å®éªŒæ”¯æŒç­‰ï¼Œæ”¯æŒé€šè¿‡ GitHub ç®¡ç†æ‰€æœ‰é…ç½®ä¸éƒ¨ç½²æµç¨‹ï¼Œå¸®åŠ©ç”¨æˆ·é«˜æ•ˆå­¦ä¹ äº‘åŸç”Ÿä¸ DevOps æŠ€æœ¯ã€‚

**æ ¸å¿ƒä»·å€¼**ï¼š

* âœ… æ‰€æœ‰ç¯å¢ƒé…ç½®å’Œéƒ¨ç½²è„šæœ¬å¯ GitHub åŒæ­¥
* âœ… æ”¯æŒ macOSã€Windowsï¼ˆå« WSLï¼‰ã€Linux è·¨å¹³å°éƒ¨ç½²
* âœ… æ”¯æŒæœ¬åœ°ï¼ˆKind/Vagrantï¼‰ä¸äº‘ç«¯ï¼ˆAzure/é˜¿é‡Œäº‘ï¼‰ç¯å¢ƒä¸€é”®éƒ¨ç½²
* âœ… é…ç½®å³ä»£ç ï¼Œéƒ¨ç½²å³å­¦ä¹ ï¼Œä¾¿äºè¿­ä»£ä¸è¿ç§»

---

## äºŒã€ç›®æ ‡ç”¨æˆ·

| ç”¨æˆ·ç±»å‹       | ç‰¹å¾è¯´æ˜                  | ä¸»è¦è¯‰æ±‚               |
| ---------- | --------------------- | ------------------ |
| åˆå­¦è€…        | æ­£åœ¨å­¦ä¹  K8s/IaC          | å¿«é€Ÿæ­å»ºæœ¬åœ°å®éªŒç¯å¢ƒ         |
| DevOps å®è·µè€… | æƒ³ç»ƒä¹  Terraform + è‡ªåŠ¨åŒ–éƒ¨ç½² | å¤šèŠ‚ç‚¹é›†ç¾¤éƒ¨ç½²ã€NFS å®è·µ     |
| æ•™è‚²æœºæ„       | æ•™å­¦ Kubernetes/äº‘åŸç”Ÿè¯¾ç¨‹   | é…å¥—ç»Ÿä¸€ç¯å¢ƒä¸ä½œä¸šæ¨¡æ¿        |
| ä¼ä¸šå°å›¢é˜Ÿ      | éœ€è¦ä¸€è‡´çš„æœ¬åœ°æµ‹è¯•ç¯å¢ƒ           | ä¸€é”®éƒ¨ç½²ã€è‡ªåŠ©è°ƒè¯•ã€å¯ Git ç®¡ç† |

---

## ä¸‰ã€äº§å“åŠŸèƒ½æ¨¡å—

| æ¨¡å— | åç§°                   | æè¿°                                              |
| -- | -------------------- | ----------------------------------------------- |
| M1 | Kind å•èŠ‚ç‚¹ç¯å¢ƒ           | ä½¿ç”¨ Terraform + Kind æ­å»º Kubernetes å­¦ä¹ é›†ç¾¤          |
| M2 | å¤šèŠ‚ç‚¹è™šæ‹Ÿæœºç¯å¢ƒ             | ä½¿ç”¨ Vagrant + VirtualBox/Vmware + Kubeadm æ„å»ºé›†ç¾¤   |
| M3 | æŒä¹…åŒ–å­˜å‚¨é…ç½®              | ä½¿ç”¨ NFS éƒ¨ç½² PVC æ¼”ç»ƒç¯å¢ƒ                              |
| M4 | å¼€å‘é…ç½®åŒæ­¥               | é€šè¿‡ GitHub + chezmoi ç®¡ç† .zshrc/.vimrc ç­‰ dotfiles |
| M5 | äº‘ç«¯éƒ¨ç½²ï¼ˆAzureï¼‰          | ä½¿ç”¨ Terraform åˆ›å»º Azure VM å¹¶éƒ¨ç½²æµ‹è¯•ç¯å¢ƒ                |
| M6 | äº‘ç«¯éƒ¨ç½²ï¼ˆé˜¿é‡Œäº‘ï¼‰            | ä½¿ç”¨ Terraform éƒ¨ç½²é˜¿é‡Œäº‘è½»é‡åº”ç”¨æœåŠ¡å™¨å¹¶é…ç½®ç¯å¢ƒ                  |
| M7 | è‡ªåŠ¨åŒ–éƒ¨ç½²è„šæœ¬              | ä¸€é”®æ‰§è¡Œï¼š`make mac k8s` / `make azure` ç­‰å‘½ä»¤éƒ¨ç½²å®Œæ•´ç¯å¢ƒ    |
| M8 | DevContainer ç¯å¢ƒ      | æä¾›è¿œç¨‹ VSCode å¼€å‘ä½“éªŒï¼ˆå¦‚ Codespacesï¼‰                  |
| M9 | GitHub Actions CI/CD | æ”¯æŒè‡ªåŠ¨éƒ¨ç½²ã€æ ¼å¼æ ¡éªŒç­‰åŸºæœ¬æµæ°´çº¿åŠŸèƒ½                             |

---

## å››ã€åŠŸèƒ½è·¯å¾„ä¸ç»“æ„

```bash
iac-lab/
â”œâ”€â”€ k8s-kind-nfs-terraform/           # M1 + M3
â”œâ”€â”€ k8s-vagrant-terraform-nfs/        # M2 + M3
â”œâ”€â”€ cloud-azure-terraform/            # M5
â”œâ”€â”€ cloud-alicloud-terraform/         # M6
â”œâ”€â”€ scripts/                          # M7
â”œâ”€â”€ .devcontainer/                    # M8
â”œâ”€â”€ .github/workflows/                # M9
â”œâ”€â”€ .tool-versions                    # M4
â”œâ”€â”€ Makefile                          # M7
â””â”€â”€ iac-lab/                          # è¯´æ˜æ–‡æ¡£å’Œå­¦ä¹ æ¨¡æ¿
```

---

## äº”ã€ä½¿ç”¨æ–¹å¼ä¸åœºæ™¯ä¸¾ä¾‹

### æœ¬åœ° K8s å®éªŒéƒ¨ç½²

```bash
make mac k8s
# æ‰§è¡Œ Kind + NFS + Pod æµ‹è¯•éƒ¨ç½²
```

### æœ¬åœ°å¤šèŠ‚ç‚¹è™šæ‹Ÿé›†ç¾¤

```bash
make mac vm
# ä½¿ç”¨ Vagrant å¯åŠ¨ Ubuntu VMï¼ŒTerraform å®‰è£… K8s + NFS
```

### äº‘ç«¯éƒ¨ç½²ï¼ˆAzureï¼‰

```bash
make azure
# åœ¨ Azure åˆ›å»ºè™šæ‹Ÿæœºå¹¶è‡ªåŠ¨é…ç½® Kubernetes + NFS
```

### é˜¿é‡Œäº‘éƒ¨ç½²è½»é‡æœåŠ¡å™¨

```bash
make alicloud
# åˆ›å»ºé˜¿é‡Œäº‘è½»é‡ ECSï¼Œå®‰è£… K3s + NFS + å®éªŒç¯å¢ƒ
```

---

## å…­ã€ä»»åŠ¡åˆ†æ‹†ï¼ˆå»ºè®®ä½¿ç”¨ GitHub Issuesã€é¡¹ç›®ç®¡ç†å·¥å…·æ‹†åˆ†ï¼‰

### ğŸ§± æ¶æ„ä¸ç»“æ„æ­å»º

* [x] åˆå§‹åŒ–é¡¹ç›®ç»“æ„ä¸ç›®å½•åˆ’åˆ†ï¼ˆå·²å®Œæˆï¼‰
* [ ] ç¼–å†™é¡¶å±‚ README ä»‹ç»é¡¹ç›®åŠŸèƒ½ã€ç»“æ„ä¸ä½¿ç”¨æ–¹å¼
* [ ] é…ç½® GitHub `.gitignore`ã€LICENSE ç­‰åŸºç¡€æ–‡ä»¶

### ğŸ³ M1 Kind + NFS

* [ ] ç¼–å†™ Kind çš„ `main.tf`
* [ ] æä¾› `kind-config.yaml` ä¸ `nfs-deploy.yaml`
* [ ] ç¼–å†™åˆå­¦è€…æ–‡æ¡£ä¸å›¾è§£éƒ¨ç½²æµç¨‹

### ğŸ’» M2 Vagrant å¤šèŠ‚ç‚¹é›†ç¾¤

* [ ] Vagrantfile ç¼–å†™ï¼ˆ2 master + 1 nodeï¼‰
* [ ] Terraform ç”Ÿæˆ K8s å®‰è£…è®¡åˆ’
* [ ] Kubeadm è„šæœ¬ + NFS éƒ¨ç½²è„šæœ¬å®Œæˆ

### â˜ï¸ M5/M6 äº‘å¹³å° Terraform è„šæœ¬

* [ ] Azure è™šæ‹Ÿæœº `main.tf` è„šæœ¬é…ç½®ï¼ˆB1s + Ubuntuï¼‰
* [ ] é˜¿é‡Œäº‘è½»é‡æœåŠ¡å™¨é…ç½®ï¼ˆé€‰æ‹©é¦™æ¸¯æˆ–æ­å·åŒºåŸŸï¼‰
* [ ] äº‘ç«¯ç¯å¢ƒè‡ªåŠ¨æ‰§è¡Œ shell è„šæœ¬å®‰è£… K3s + NFS

### ğŸ§ª M7 ä¸€é”®éƒ¨ç½²å…¥å£

* [ ] ç¼–å†™ `Makefile` å‘½ä»¤å…¥å£
* [ ] æä¾› `scripts/` ä¸­çš„ `deploy_xxx.sh` æ‰§è¡Œé€»è¾‘
* [ ] ç¼–å†™ `scripts/utils.sh`ï¼ˆæ£€æµ‹å¹³å°ã€ä¾èµ–å®‰è£…ï¼‰

### ğŸ§° M4 å¼€å‘é…ç½®åŒæ­¥

* [ ] åˆå§‹åŒ– `.tool-versions` ç¤ºä¾‹ï¼ˆNode.js, Go, Pythonï¼‰
* [ ] åˆ›å»º `chezmoi` ç¤ºä¾‹é…ç½®ï¼ˆ.zshrc/.vimrcï¼‰

### âš™ï¸ M8 VSCode DevContainer

* [ ] `devcontainer.json` ä¸­é¢„è®¾ terraform, kubectl, helm ç­‰
* [ ] æä¾› Dockerfile æˆ–ä½¿ç”¨åŸºç¡€é•œåƒï¼ˆå¦‚ `mcr.microsoft.com/devcontainers/base:ubuntu`ï¼‰

### ğŸ” M9 GitHub Actions è‡ªåŠ¨åŒ–

* [ ] æ·»åŠ  `terraform fmt` æ ¡éªŒæµæ°´çº¿
* [ ] è„šæœ¬éƒ¨ç½²é¢„è§ˆ
* [ ] è®¡åˆ’å‘å¸ƒç‰ˆæœ¬æ‰“åŒ…æµç¨‹

---

## ä¸ƒã€ç‰ˆæœ¬è¿­ä»£è®¡åˆ’

| ç‰ˆæœ¬   | åŠŸèƒ½                            | æ—¶é—´ç›®æ ‡    |
| ---- | ----------------------------- | ------- |
| v0.1 | å®Œæˆ Kind + NFS å•èŠ‚ç‚¹å­¦ä¹ ç¯å¢ƒ         | 2025-06 |
| v0.2 | æ”¯æŒå¤šèŠ‚ç‚¹è™šæ‹Ÿæœºç¯å¢ƒ + Kubeadm éƒ¨ç½²       | 2025-07 |
| v0.3 | æ‰©å±• ArgoCD/Ingress/Grafana æ¨¡å—  | 2025-08 |
| v0.4 | Azure äº‘ç¯å¢ƒéƒ¨ç½²æ”¯æŒ                 | 2025-09 |
| v0.5 | é˜¿é‡Œäº‘è½»é‡æœåŠ¡å™¨éƒ¨ç½²æ”¯æŒ                  | 2025-10 |
| v0.6 | è‡ªåŠ¨åŒ–ä¸€é”®éƒ¨ç½²ã€Makefileã€DevContainer | 2025-11 |
| v1.0 | é¡¹ç›®å¼€æºå‘å¸ƒã€æ•´ç†æ•™ç¨‹                   | 2025-12 |

---

## å…«ã€é™„å½•

* å®˜æ–¹å‚è€ƒï¼š

  * [Terraform å®˜ç½‘](https://www.terraform.io/)
  * [Kind é¡¹ç›®](https://kind.sigs.k8s.io/)
  * [Vagrant å®˜ç½‘](https://www.vagrantup.com/)
  * [Azure Terraform Provider](https://registry.terraform.io/providers/hashicorp/azurerm)
  * [é˜¿é‡Œäº‘ Terraform Provider](https://registry.terraform.io/providers/aliyun/alicloud)
* äº‘å¹³å°æ–‡æ¡£ï¼š

  * [Azure å…è´¹è´¦æˆ·](https://azure.microsoft.com/zh-cn/free/)
  * [é˜¿é‡Œäº‘è½»é‡æœåŠ¡å™¨äº§å“è¯´æ˜](https://www.aliyun.com/product/swas)
